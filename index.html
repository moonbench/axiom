<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Untitled project</title>

  <style type="text/css">
    body{
      background-color: #050505;
      color: #BEBEBE;
      font-family: arial, sans-serif;
    }
    #fps_meter{
      width: 800px;
      margin: 0px auto;
      min-height: 4em;
    }
    #game_canvas{
      border: 1px solid #333;
      background-color: #000;
      cursor: none;
      display: block;
      margin: 0px auto;
    }
    #container{
      width: 800px;
      margin: 0px auto;
      position: relative;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="fps_meter">
    </div>
    <div id="game">
      <canvas id="game_canvas" width="800" height="600"></canvas>
    </div>
  </div>
  <script type="text/javascript" src="js/util.js"></script>
  <script type="text/javascript" src="js/vector.js"></script>
  <script type="text/javascript" src="js/cursor.js"></script>
  <script type="text/javascript" src="js/meter.js"></script>
  <script type="text/javascript" src="js/viewport.js"></script>
  <script type="text/javascript" src="js/asset_depot.js"></script>
  <script type="text/javascript" src="js/entity.js"></script>
  <script type="text/javascript" src="js/solid_entity.js"></script>
  <script type="text/javascript" src="js/moveable_entity.js"></script>
  <script type="text/javascript" src="js/driveable_entity.js"></script>
  <script type="text/javascript" src="js/shooting_entity.js"></script>
  <script type="text/javascript" src="js/missile_entity.js"></script>
  <script type="text/javascript" src="js/damageable_entity.js"></script>
  <script type="text/javascript" src="js/gun.js"></script>
  <script type="text/javascript" src="js/sprite.js"></script>
  <script type="text/javascript" src="js/layer.js"></script>
  <script type="text/javascript" src="js/quadtree.js"></script>
  <script type="text/javascript" src="js/world.js"></script>
  <script type="text/javascript" src="js/audio_emitter.js"></script>
  <script type="text/javascript" src="js/engine.js"></script>

  <script type="text/javascript">
    const world = World.create(3000, 2000);
    const engine = Engine.create(world, "game_canvas", "fps_meter");

    engine.assets.add_image("test", "assets/fighter2.png");
    const car = ShootingEntity.extend(DriveableEntity.extend(MoveableEntity.extend(SolidEntity.extend(Sprite.create(600, 200, 80, 85, Math.PI, engine.assets.images["test"])))));
    car.is_selected = true;
    world.add_player_entity(car);

    engine.assets.add_image("ship1", "assets/ship1.png");
    for(var i = 0; i<10; i++){
      world.add_entity(DamageableEntity.extend(
        MoveableEntity.extend(
          SolidEntity.extend(
            Sprite.create(300+Math.random()*400, 600+Math.random()*500, 40, 70, Math.random()*Math.PI*2, engine.assets.images["ship1"])
            )
          )
        )
      );
    }

    engine.assets.add_image("trash", "assets/trash.png");
    world.add_entity(SolidEntity.extend(Sprite.create(1200, 900, 300, 300, 3*Math.PI/4, engine.assets.images["trash"] )));
    world.add_entity(SolidEntity.extend(Sprite.create(1200, 300, 100, 100, Math.PI/4, engine.assets.images["trash"] )));
    world.add_entity(SolidEntity.extend(Sprite.create(1200, 150, 100, 100, 2*Math.PI/4, engine.assets.images["trash"] )));
    world.add_entity(SolidEntity.extend(Sprite.create(1200, 450, 100, 100, 3*Math.PI/4, engine.assets.images["trash"] )));
    world.add_entity(SolidEntity.extend(Sprite.create(1500, 300, 100, 100, 4*Math.PI/4, engine.assets.images["trash"] )));

    engine.audio.add_to_group("bg", engine.assets.add_audio("bg1", "assets/bg.mp3"));
    engine.audio.add_to_group("bg", engine.assets.add_audio("bg2", "assets/bg2.mp3"));
    engine.audio.loop("bg", function(){ return true; });
    engine.audio.add_to_group("gun", engine.assets.add_audio("laser1", "assets/laser1.mp3"));
    engine.audio.add_to_group("gun", engine.assets.add_audio("laser2", "assets/laser2.mp3"));
    engine.audio.add_to_group("gun", engine.assets.add_audio("laser3", "assets/laser3.mp3"));
    engine.audio.add_to_group("gun", engine.assets.add_audio("laser4", "assets/laser4.mp3"));
    engine.audio.add_to_group("gun", engine.assets.add_audio("laser5", "assets/laser5.mp3"));
    engine.audio.add_to_group("hit", engine.assets.add_audio("bang1", "assets/bang1.mp3"));
    engine.audio.add_to_group("hit", engine.assets.add_audio("bang2", "assets/bang2.mp3"));
    engine.audio.add_to_group("hit", engine.assets.add_audio("bang3", "assets/bang3.mp3"));
    engine.audio.add_to_group("hit", engine.assets.add_audio("bang4", "assets/bang4.mp3"));
    engine.audio.add_to_group("thruster", engine.assets.add_audio("thruster1", "assets/thruster2.mp3"));
    engine.assets.add_image("laser1", "assets/laser1.png");

    engine.assets.add_image("ship2", "assets/ship2.png");
    world.add_entity(Sprite.create(1200, 1000, 500, 900, 4, engine.assets.images["ship2"]), 40);

    world.add_entity( Sprite.create(500, 900, 400, 800, 6, engine.assets.images["ship2"]), 20);

    engine.assets.add_image("ship3", "assets/ship3.png");
    world.add_entity( Sprite.create(5000, 1900, 500, 1000, 5, engine.assets.images["ship3"]), 18);
    engine.assets.add_image("ship4", "assets/ship4.png");
    const some_ship = MoveableEntity.extend(Sprite.create(1500, 3000, 400, 800, 0.8, engine.assets.images["ship4"]));
    some_ship.state.forward = true;
    some_ship.max_acceleration = 0.5;
    world.add_entity(some_ship, 26);

    world.add_entity( Sprite.create(1200, 1500, 600, 1000, 2.5, engine.assets.images["ship2"]), 120);

    engine.assets.add_image("planet", "assets/planet.jpg");
    const planet = Sprite.create(world.width/2, world.height/2, world.height, world.width*1.2, 0, engine.assets.images["planet"]);
    world.add_entity(planet, 10);

    engine.run();
  </script>
</body>
</html>
